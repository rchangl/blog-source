# 外键

一个表对另一个表的引用。创建表时，先创建主表，删除表时，先删除从表。

## 表

主表、引用表：被引用的表  
从表： 通过外键引用主表

**创建和删除顺序**：创建表时，先创建主表，后建立从表；删除表时反之，先删除从表，后删除主表。

即 建立表时，保证被引用的表存在，删除表时，保证删除的表没有被引用。类似于程序中的防止空指针。

## 数据

被引用的必须保证唯一，即 必须为 主键约束 或 唯一约束

## 问题

在数据库中使用外键容易导致一些问题，阿里中禁止使用外键，原本外键的部分逻辑写在程序中。

性能问题，额外的数据一致性校验查询。每次做DELETE或者UPDATE都必须考虑外键约束，会导致开发时更困难，测试数据极为不方便

并发问题，外键约束会启用行级锁，主表写入时会进入阻塞。

级联删除问题，多层级联删除会上数据变得不可控，触发器也严格被禁用。

数据耦合，数据库层面数据关系产生耦合，数据迁移维护困难

## 逻辑外键

一般说外键是指数据库的外键，不通过数据库实现外键的功能，而是**通过程序**来实现外键的功能，把工作交给应用层，即为逻辑外键
